<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="initial-scale=1" />

		<link rel="icon" href="/images/favicon.png" />

		<meta
			name="description"
			content="<%= htmlWebpackPlugin.options.description %>"
			data-react-helmet="true"
		/>
		<link
			rel="alternate"
			hreflang="en"
			href="https://nosgestesclimat.fr/?lang=en"
			data-react-helmet="true"
		/>
		<link
			rel="alternate"
			hreflang="fr"
			href="https://nosgestesclimat.fr/?lang=fr"
			data-react-helmet="true"
		/>
		<link
			rel="alternate"
			hreflang="x-default"
			href="https://nosgestesclimat.fr"
			data-react-helmet="true"
		/>

		<meta property="og:type" content="website" data-react-helmet="true" />
		<meta
			property="og:title"
			data-react-helmet="true"
			content="<%= htmlWebpackPlugin.options.title %>"
		/>
		<meta
			property="og:description"
			data-react-helmet="true"
			content="<%= htmlWebpackPlugin.options.description %>"
		/>

		<meta
			property="og:image"
			content="<%= htmlWebpackPlugin.options.logo %>"
			data-react-helmet="true"
		/>
		<meta
			name="google-site-verification"
			content="oQ9gPKS4kocrCJP6CoguSkdIKKZ6ilZz0aQw_ZIgtVc"
		/>

		<meta
			property="twitter:card"
			content="summary_large_image"
			data-react-helmet="true"
		/>

		<link rel="manifest" href="/manifest.webmanifest" />
		<title><%= htmlWebpackPlugin.options.title %></title>

		<style>
			html[data-useragent*='MSIE'] #outdated-browser,
			html[data-useragent*='Safari'][data-useragent*='Version/8']
				#outdated-browser,
			html[data-useragent*='Safari'][data-useragent*='Version/7']
				#outdated-browser,
			html[data-useragent*='Trident'] #outdated-browser {
				display: block !important;
			}

			html[data-useragent*='MSIE'] #js,
			html[data-useragent*='Safari'][data-useragent*='Version/8'] #js,
			html[data-useragent*='Safari'][data-useragent*='Version/7'] #js,
			html[data-useragent*='Trident'] #js {
				display: none !important;
			}
		</style>
		<meta name="theme-color" content="#5758BB" />

		<script type="text/javascript">
			/* 
				Manually setting Netlify code spliting cookie in iframe with sameSite=None and secure. 
				See : https://answers.netlify.com/t/running-split-tests-in-an-iframe-adjust-nf-ab-cookie-settings/28754
			*/
			if (window.location.href.includes('iframe')) {
				let cookieIsSet = document.cookie.includes('nf_ab')
				if (!cookieIsSet) {
					document.cookie = `nf_ab=${Math.random()}; sameSite=None; secure=true`
					window.location.reload(true) // We need to reload the page for the client to match the server
				}
			}
		</script>
	</head>

	<body>
		<!-- USER AGENT DATA ATTRIBUTE  -->

		<script>
			var b = document.documentElement
			b.setAttribute('data-useragent', navigator.userAgent)
		</script>
		<script>
			if (
				typeof navigator != 'undefined' &&
				/prerender/i.test(navigator.userAgent)
			) {
				// This is needed because of an incompatibility between styled components and prerender.io
				SC_DISABLE_SPEEDY = true

				FORCE_LANGUAGE = 'fr'
			}
		</script>

		<!-- APP  -->
		<div id="js"></div>

		<!-- OUTDATED BROWSER WARNING -->
		<div
			id="outdated-browser"
			style="
				position: fixed;
				top: 0;
				left: 0;
				bottom: 0;
				right: 0;
				display: none;
				background-color: white;
			"
		>
			<div
				style="
					margin: 100px auto;
					max-width: 800px;
					text-align: center;
					font-family: sans-serif;
					font-weight: 300;
				"
			>
				<h1>Votre navigateur n'est plus supporté.</h1>
				<h2>
					Nous vous invitons à réessayer avec un autre, ou depuis un mobile
					récent.
				</h2>
				<br />
				<br />
				<h3>
					Si besoin, vous pouvez en installer un nouveau depuis
					<a style="color: #2975d1" href="https://outdatedbrowser.com/fr"
						>cette page</a
					>
				</h3>
				<h3>
					<button
						onclick="
					var b = document.documentElement;
					b.setAttribute('data-useragent',  'force-navigation-anyway');
				"
					>
						Continuer quand même vers le site
					</button>
				</h3>
			</div>
		</div>

		<!-- Matomo : track only production code-->
		<% if (htmlWebpackPlugin.options.injectTrackingScript) { %>

		<!-- Matomo -->
		<script type="text/javascript">
			var _paq = window._paq || []
			/* tracker methods like "setCustomDimension" should be called before "trackPageView" */
			if (!window.location.pathname.match(/\/(sondage|conférence|enquête)\//)) {
				_paq.push(['trackPageView'])
			}
			_paq.push(['enableLinkTracking'])
			;(function () {
				var u = '//stats.data.gouv.fr/'
				_paq.push(['setTrackerUrl', u + 'matomo.php'])
				_paq.push(['setSiteId', '153'])

				var d = document,
					g = d.createElement('script'),
					s = d.getElementsByTagName('script')[0]
				g.type = 'text/javascript'
				g.async = true
				g.defer = true
				g.src = u + 'matomo.js'
				s.parentNode.insertBefore(g, s)
			})()
		</script>
		<% } %>
		<!-- End Matomo Code -->

		<!-- Polyfill and source for old browser -->
		<!-- Add polyfill.io for a very narrow web feature
			IntersectionObserver : SAFARI 11 & 12.0  https://caniuse.com/#search=intersectionobserver
		-->
		<script src="https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver"></script>
	</body>
</html>
